<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Job Portal</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@500;700&display=swap" rel="stylesheet">

  <style>
    :root {
      --bg-deep-black: #000000;
      --bg-card-surface: #0A0A0A;
      --accent-cyan: #00FFFF;
      --border-primary: #374151;
    }

    body {
      background-color: var(--bg-deep-black);
      color: white;
      font-family: 'Roboto Mono', monospace;
    }

    .header-blur {
      background: rgba(0,0,0,0.9);
      backdrop-filter: blur(8px);
      border-bottom: 1px solid var(--border-primary);
    }

    .card {
      background: var(--bg-card-surface);
      border: 1px solid var(--border-primary);
      border-radius: 22px;
      padding: 1.5rem;
      transition: transform .4s ease, border-color .4s ease;
    }
    .card:hover {
      transform: translateY(-8px);
      border-color: var(--accent-cyan);
    }

    .fade {
      animation: fadeUp 0.8s ease both;
    }

    @keyframes fadeUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .accent { color: var(--accent-cyan); }

    /* ✅ FIXED FULLSCREEN AUTH BACKGROUND */
   .auth-bg {
  position: fixed;
  inset: 0;
  width: 100vw;
  height: 100vh;

  background-image: url("https://images.unsplash.com/vector-1747765483677-e3ad55df3ada?q=80&w=880&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D");
  background-repeat: no-repeat;
  background-position: center center;
  background-size: cover;        /*  FILL ENTIRE SCREEN */
  
  z-index: 90;


}

    .auth-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.60);
  display: flex;
  align-items: center;
  justify-content: center;
}


    .auth-card {
      background: rgba(10, 10, 10, 0.92);
      border: 1px solid var(--border-primary);
      border-radius: 22px;
      box-shadow: 0 25px 70px rgba(0,0,0,0.7);
    }

    <!-- #three-bg {
    position: fixed;
    inset: 0;
    width: 100%;
    height: 100%;
    z-index: -5;   /* stays behind everything */
    }
    canvas {
    display: block;
    }

    #three-blur-layer {
    position: fixed;
    inset: 0;
    backdrop-filter: blur(8px);
    -webkit-backdrop-filter: blur(8px);
    z-index: -4;
    pointer-events: none;
    }

    canvas {
    display: block;
    } -->

    /* ✅ Static background after login */
    #static-bg {
    position: fixed;
    inset: 0;
    background-image: url("assets/undraw_hiring_8szx.svg");
    background-size: 30%;          /* Try 60%, 70%, or 80% */
    background-position: center 90%;
    background-repeat: no-repeat;

    background-color: #eaecf3;
    z-index: -6;
    opacity: 1;
    transition: opacity 0.8s ease;
    }

    #static-bg.active {
    opacity: 1;
    }

    /* ✅ Hide particles when logged in */
    .hide-three #three-bg,
    .hide-three #three-blur-layer {
    display: none;
    }



  </style>
</head>

<body class="antialiased">
<div id="three-bg"></div>
<div id="three-blur-layer"></div>
<div id="static-bg"></div>




<!-- NAVBAR -->
<header class="header-blur fixed top-0 left-0 w-full z-[200]">
  <div class="w-full flex justify-between items-center px-6 py-4">
    <h1 class="text-xl font-bold tracking-widest">Placely</h1>
    <div id="navActions" class="space-x-4 hidden">
    <span id="navWelcome" class="text-cyan-400 font-semibold"></span>
    <button onclick="logout()" class="text-red-400 hover:text-red-300 text-sm">
        LOGOUT
    </button>
    </div>

    <div id="navAuth" class="space-x-4">
    <button onclick="show('login')" class="text-gray-400 hover:text-white">LOGIN</button>
    <button onclick="show('signup')" class="text-gray-400 hover:text-white">SIGNUP</button>
    </div>

  </div>
</header>

<!-- ======================= PORTAL (LOCKED UNTIL LOGIN) ======================= -->
<main class="pt-28 max-w-6xl mx-auto px-6">

  <!-- HOME (HIDDEN BY DEFAULT) -->
  <section id="home" class="hidden grid md:grid-cols-3 gap-8 fade">

  </section>

  <!-- DASHBOARD -->
  <section id="dashboard" class="hidden fade text-center card p-6 mt-16 max-w-md mx-auto">
    <h2 class="text-xl mb-2">DASHBOARD</h2>
    <p id="userInfo" class="text-gray-400"></p>
    <button onclick="logout()" class="mt-4 text-red-400">LOGOUT</button>
  </section>

  <!-- APPLY -->
  <section id="apply" class="hidden fade max-w-sm mx-auto mt-16 card p-6">
    <h2 class="text-xl mb-4">APPLY JOB</h2>

    <input class="w-full p-2 mb-3 bg-black border border-gray-700 rounded" placeholder="Full Name">
    <input class="w-full p-2 mb-3 bg-black border border-gray-700 rounded" placeholder="Email">
    <input class="w-full p-2 mb-4 bg-black border border-gray-700 rounded" placeholder="Resume Link">

    <button class="w-full border border-cyan-400 py-2 hover:bg-cyan-400 hover:text-black transition">
      SUBMIT
    </button>
  </section>
 
    <!-- JOB DETAIL -->
    <section id="jobList" class="grid md:grid-cols-3 gap-8"></section>

    <section id="jobDetail" class="hidden max-w-3xl mx-auto mt-16 card p-8 fade">
    <h2 id="jdTitle" class="text-2xl font-bold mb-2"></h2>
    <p id="jdCompany" class="text-gray-400"></p>
    <p id="jdLocation" class="text-gray-500 mb-4"></p>

    <p class="text-lg font-semibold mt-4">Job Description</p>
    <p id="jdDesc" class="text-gray-400 mb-4"></p>

    <p class="text-lg font-semibold">Requirements</p>
    <p id="jdReq" class="text-gray-400 mb-6"></p>

    <button id="applyRedirect"
      class="border border-cyan-400 px-6 py-2 rounded hover:bg-cyan-400 hover:text-black transition">
      APPLY NOW
    </button>

    <p onclick="show('home')" class="mt-6 text-sm text-gray-500 cursor-pointer">
      ← Back to Jobs
    </p>
  </section>

</main>

<!-- ======================= LOGIN ======================= -->
<section id="login" class="auth-bg">
  <div class="auth-overlay">
    <div class="auth-card w-full max-w-sm p-8 fade">
      <h2 class="text-2xl font-bold mb-6 text-center">LOGIN</h2>

      <input id="loginEmail"
        class="w-full p-3 mb-4 bg-black border border-gray-700 rounded-xl text-white"
        placeholder="Email">

      <input id="loginPass" type="password"
        class="w-full p-3 mb-6 bg-black border border-gray-700 rounded-xl text-white"
        placeholder="Password">

      <button onclick="login()"
        class="w-full border border-cyan-400 py-3 rounded-xl hover:bg-cyan-400 hover:text-black transition">
        LOGIN
      </button>

      <p class="text-center text-gray-300 mt-6 text-sm">
        Don’t have an account?
        <span onclick="show('signup')" class="accent cursor-pointer">SIGNUP</span>
      </p>
    </div>
  </div>
</section>

<!-- ======================= SIGNUP ======================= -->
<section id="signup" class="hidden auth-bg">
  <div class="auth-overlay">
    <div class="auth-card w-full max-w-sm p-8 fade">
      <h2 class="text-2xl font-bold mb-6 text-center">SIGNUP</h2>

      <input id="name"
        class="w-full p-3 mb-4 bg-black border border-gray-700 rounded-xl text-white"
        placeholder="Name">

      <input id="email"
        class="w-full p-3 mb-4 bg-black border border-gray-700 rounded-xl text-white"
        placeholder="Email">

      <input id="password" type="password"
        class="w-full p-3 mb-6 bg-black border border-gray-700 rounded-xl text-white"
        placeholder="Password">

      <button onclick="signup()"
        class="w-full border border-cyan-400 py-3 rounded-xl hover:bg-cyan-400 hover:text-black transition">
        REGISTER
      </button>

      <p class="text-center text-gray-300 mt-6 text-sm">
        Already have an account?
        <span onclick="show('login')" class="accent cursor-pointer">LOGIN</span>
      </p>
    </div>
  </div>    
</section>




<!-- ======================= JAVASCRIPT ======================= -->
<script>
/*  ADD jobDetail HERE */
const sections = ["home","login","signup","dashboard","apply","jobDetail"];

//  Show one section at a time
function show(id){
  sections.forEach(sec => {
    const el = document.getElementById(sec);
    if(el){
      el.classList.add("hidden");
    }
  });

  const active = document.getElementById(id);
  if(active){
    active.classList.remove("hidden");
  }

  if(id === "login" || id === "signup"){
    document.body.style.overflow = "hidden";
  } else {
    document.body.style.overflow = "auto";
  }
}

//  LOAD JOBS FROM BACKEND
function loadJobs(){
  fetch("http://localhost:8081/jobs/all")
    .then(res => res.json())
    .then(jobs => {
      const jobList = document.getElementById("jobList");
      jobList.innerHTML = "";

      jobs.forEach(job => {
        jobList.innerHTML += `
          <div class="card">
            <h3 class="text-xl font-bold mb-2">${job.title}</h3>
            <p class="text-gray-400">${job.company}</p>
            <p class="text-gray-500 mb-3">${job.location}</p>
            <button onclick="viewJob(${job.id})" class="accent font-semibold">
              APPLY →
            </button>
          </div>
        `;
      });
    });
}

//  VIEW SINGLE JOB DETAIL PAGE
function viewJob(id){
  console.log("Clicked job ID:", id);

  fetch(`http://localhost:8081/jobs/${id}`)
    .then(res => res.json())
    .then(job => {

      console.log("Fetched job:", job);

      document.getElementById("jdTitle").innerText = job.title;
      document.getElementById("jdCompany").innerText = job.company;
      document.getElementById("jdLocation").innerText = job.location;
      document.getElementById("jdDesc").innerText = job.description;
      document.getElementById("jdReq").innerText = job.requirements;

      const btn = document.getElementById("applyRedirect");
      btn.onclick = () => window.open(job.applyLink, "_blank");

      show("jobDetail");
    })
    .catch(err => {
      console.error("Error loading job:", err);
      alert("Failed to load job details.");
    });
}


//  SIGNUP
function signup(){
  const nameVal = document.getElementById("name").value;
  const emailVal = document.getElementById("email").value;
  const passwordVal = document.getElementById("password").value;

  fetch("http://localhost:8081/signup",{
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body: JSON.stringify({
      name: nameVal,
      email: emailVal,
      password: passwordVal
    })
  })
  .then(r => r.text())
  .then(msg => {
    alert(msg);
    show("login");
  });
}

//  LOGIN
function login(){
  fetch("http://localhost:8081/signin",{
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body: JSON.stringify({
      email: loginEmail.value,
      password: loginPass.value
    })
  })
  .then(r => r.json())
  .then(u => {
    if(u && u.name){
      localStorage.setItem("user", JSON.stringify(u));

      // ✅ SHOW WELCOME NAME
      document.getElementById("navWelcome").innerText = "Welcome " + u.name;
      document.getElementById("navAuth").classList.add("hidden");
      document.getElementById("navActions").classList.remove("hidden");
      document.body.classList.add("hide-three");
      document.getElementById("static-bg").classList.add("active");


      show("home");
      loadJobs();
    } else {
      alert("Invalid Credentials");
    }
  })
  .catch(err => {
    console.error("Login Error:", err);
    alert("Login failed");
  });
}

//  LOGOUT → LOCK AGAIN
function logout(){
  localStorage.clear();

  document.body.classList.remove("hide-three");
  document.getElementById("static-bg").classList.remove("active");

  document.getElementById("navWelcome").innerText = "";
  document.getElementById("navActions").classList.add("hidden");
  document.getElementById("navAuth").classList.remove("hidden");

  show("login");
}

//  ON PAGE LOAD → AUTO LOGIN IF USER EXISTS
window.onload = function(){
  const user = localStorage.getItem("user");

  if(user){
    const u = JSON.parse(user);

    document.getElementById("navWelcome").innerText = "Welcome " + u.name;
    document.getElementById("navAuth").classList.add("hidden");
    document.getElementById("navActions").classList.remove("hidden");

    // ✅ Static BG on refresh
    document.body.classList.add("hide-three");
    document.getElementById("static-bg").classList.add("active");

    show("home");
    loadJobs();
  } else {
    show("login");
  }
}

</script>

</body>
</html>
